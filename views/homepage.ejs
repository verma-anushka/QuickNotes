<% include partials/header.ejs %>

<% var found = "false"; %>

<% if(notes){ %>

<% notes.forEach(function(note){ %>
    <% if( note.author.id.equals(user._id) ){ %>
        <% found = "true"; %>
    <% } %>
<% }); %>
<% } %>

<% if( found == "true" ){ %>
    
    <div class="home-container">
        <div class="row">

                <div class="notes-container">
                    <div>
                        <h1 >Welcome back, <%= user.username %> !
                            <a href="/<%= user._id %>/notes/new"><i class="fa fa-plus"></i></a>
                        </h1>
                    </div>
                </div>

                <div id="filters-container" class="cbp-l-filters-alignCenter">
                    <div data-filter="*" class="cbp-filter-item-active cbp-filter-item">
                        ALL NOTES<div class="cbp-filter-counter"></div>
                    </div> /
                    <div data-filter=".blank" class="cbp-filter-item">
                        BLANK<div class="cbp-filter-counter"></div>
                    </div> /
                    <div data-filter=".to-do" class="cbp-filter-item">
                        TO-DO LIST<div class="cbp-filter-counter"></div>
                    </div> /
                    <div data-filter=".lecture" class="cbp-filter-item">
                        LECTURE<div class="cbp-filter-counter"></div>
                    </div> /
                    <div data-filter=".meeting" class="cbp-filter-item">
                        MEETING<div class="cbp-filter-counter"></div>
                    </div> /
                    <div data-filter=".planner" class="cbp-filter-item">
                        PLANNER<div class="cbp-filter-counter"></div>
                    </div> /
                    <div data-filter=".daily-reflection" class="cbp-filter-item">
                        DAILY REFLECTION<div class="cbp-filter-counter"></div>
                    </div> /
                    <div data-filter=".meal-planner" class="cbp-filter-item">
                        MEAL PLANNER<div class="cbp-filter-counter"></div>
                    </div>
                </div>

                <div class="col-md-offset-1 col-md-10 col-sm-6 allNotes">
                    <section id="works" class="page-content">

                        <div id="grid-container" class="cbp">
                            
                            <% for( var i=0; i < notes.length; i++){ %>                            
                                
                                <% if( notes[i].author.id.equals(user._id) ){ %>    
                                    <% if( notes[i].type == "blank" ){ %>

                                        <div class="cbp-item blank">
                                            <div class="cbp-caption" style="float: left;">
                                                <div class="cbp-caption-defaultWrap">
                                                    <img src="/images/blank.jpg" alt="">
                                                </div>
                                                <div class="cbp-caption-activeWrap">
                                                    <div class="cbp-l-caption-alignLeft">
                                                        <div class="cbp-l-caption-body">
                                                            <div class="cbp-l-caption-title"><%- notes[i].title %></div>
                                                            <div class="cbp-l-caption-desc"><%- notes[i].description %></div>
                                                        </div>
                                                    </div>
                                                    <div class="formatting">
                                                        <span class="share">
                                                                <% console.log( "notes[i].id" ) %>
                                                                <% console.log( notes[i].id ) %>
                                                            <a href="#shareNoteModal" class="noteShare" data-note="<%- notes[i].id%>" data-toggle="modal">
                                                                share                                   
                                                                
                                                            </a>            
                                                        </span>
                                                        <span id="delete">
                                                            <form id="delete-form" action="/<%= user._id %>/notes/<%= notes[i]._id %>?_method=DELETE" method="POST">
                                                                <button >
                                                                    <i class="fa fa-trash"></i>
                                                                </button>
                                                            </form>                                    
                                                        </span>
                                                        <span id="edit">
                                                            <a href="/<%= user._id %>/notes/<%= notes[i]._id %>/edit">
                                                                <i class="fa fa-edit"></i>
                                                            </a>            
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>


                                    <% } %>

                                    
                                <% } %>

                            <% }; %>
                        </div> 
                    </section>   
                </div>  
        </div>
    </div>
 
<% } else{ %>
    <div class="no-notes">
        <div class="hero-image">
            <div class="col-md-offset-2 col-md-8 no-notes-container">
                <h1>Hello, <%= user.username %> !</h1>
                <div class="thumbnail">
                    <div class="img-container">
                        <img class="avatar" src="<%= user.image%>" alt="Avatar">
                    </div>
                </div>
                <h3>You haven't created any notes yet!</h3>
                <a href="/<%= user._id %>/notes/new" class="btn">Create Now!</a>
                <br />
                <a class="notes-buttons" href="/<%= user._id %>/notes/new">
                    <button class="pulse-button-hover tool" data-tip="Blank Note" tabindex="1">
                        <i class="fa fa-sticky-note"></i>
                    </button>
                </a>
                <a href="/<%= user._id %>/notes/new">
                    <button class="pulse-button-hover tool" data-tip="To-Do List" tabindex="2">
                        <i class="fa fa-clipboard-list"></i>
                    </button>
                </a>
                <a href="/<%= user._id %>/notes/new">
                    <button class="pulse-button-hover tool" data-tip="Lecture Note" tabindex="3">
                        <i class="fa fa-file-word"></i>
                    </button>
                </a>
                <a href="/<%= user._id %>/notes/new">
                    <button class="pulse-button-hover tool" data-tip="Meeting Note" tabindex="4">
                        <i class="fa fa-handshake"></i>
                    </button>
                </a>
                <a href="/<%= user._id %>/notes/new">
                    <button class="pulse-button-hover tool schedule" data-tip="Schedule Planner" tabindex="5">
                        <i class="fa fa-calendar-alt"></i>
                    </button>
                </a>
                <a href="/<%= user._id %>/notes/new">
                    <button class="pulse-button-hover tool daily" data-tip="Daily Reflection" tabindex="6">
                        <i class="fas fa-cloud-sun"></i>
                    </button>
                </a>
                <a href="/<%= user._id %>/notes/new">
                    <button class="pulse-button-hover tool" data-tip="Meal Planner" tabindex="7"> 
                        <i class="fas fa-utensils"></i>
                    </button>
                </a>
                
            </div>
        </div>
    </div>
<% } %> 
<form action="/<%= user._id %>/notes/share" method="GET">
    <div class="modal" id="shareNoteModal" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">

                <!-- Header -->
                <div class="m-header">
                    <!-- Close button -->
                    <button class="close" data-dismiss="modal">&times;</button>
                    <h4 id="myModalLabel"> Share Notes! </h4>
                    <br />
                </div>

                <!-- Body -->
                <div class="inputs">

                    <!-- Receiver Email-ID -->
                    <div class="form-group input-group">
                        <label for="receiverEmail" class="sr-only">Email-ID</label>
                        <span class="input-group-addon"><i class="fa fa-user"></i></span>
                        <input type="text" class="form-control" id="receiverEmail" name="shareUser[receiverEmail]" placeholder="Enter the Receiver's Email-ID" maxlength="30" required>
                    </div>

                    <!-- Receiver Name -->
                    <div class="form-group input-group">
                        <label for="receiverName" class="sr-only">Name</label>
                        <span class="input-group-addon"><i class="fa fa-user"></i></span>
                        <input type="text" class="form-control" id="receiverName" name="shareUser[receiverName]" placeholder="Enter the Receiver's Name" maxlength="30" required>
                    </div>

                    <!-- Note ID -->
                    <div class="form-group input-group note-id-input">
                    </div>

                    <div class="form-group input-group">
                        <label for="receiverMsg" class="sr-only">Message for Receiver</label>
                        <span class="input-group-addon"><i class="fa fa-user"></i></span>
                        <input type="text" class="form-control" id="receiverMsg" name="shareUser[receiverMsg]" placeholder="Any other message..." maxlength="300">
                    </div>

                </div>

                <!-- Footer -->
                <div class="footer">
                    <button type="submit" class="btn" name="form" value="share">
                        Share
                    </button>
                </div>
            </div>
        </div>
    </div>
</form>


<% include partials/footer.ejs %>

